% -*- root: thesis.tex -*-

%----------------------------------------------------------------------------
% document options
\newcommand{\myTitle}{Statistical Eco(-toxico)logy - Improving the utilization of data for ecological risk assessment}
\newcommand{\myTitleOnTitlePageLineOne}{Statistical Eco(-toxico)logy}
\newcommand{\myTitleOnTitlePageLineTwo}{Improving the utilization of data for ecological risk assessment}
\newcommand{\myName}{Eduard Sz\"{o}cs}
\newcommand{\myUni}{\protect{Universität Koblenz-Landau}}
% comma below small s (romanian, see https://groups.google.com/forum/#!topic/diacritice/vxT3RYdZDHc)
\newcommand{\sh}{\ooalign{s\crcr\hidewidth\raise-.31ex\hbox{\scriptsize,}\hidewidth}}
\newcommand{\myLocation}{Z\v{a}rne\c{s}ti / Romania}


%----------------------------------------------------------------------------
% list all packages/files in log files
\listfiles
% use ragged bottom (=no vertical stretch of paragraphs (=\flushbottom))
\raggedbottom


%----------------------------------------------------------------------------
% character encoding and languages
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage[final]{microtype}
\usepackage[hyphens]{url}


%----------------------------------------------------------------------------
% custom date format (for titlepage)
\usepackage[nodayofweek]{datetime}
%dd. monthname YYYY
\newdateformat{mydate}{%
    \THEDAY.\ \monthname[\THEMONTH] \THEYEAR%
    }
\newcommand{\myTime}{\mydate{\today}}
%! change today to actual date! e.g. 5. December 2016


%----------------------------------------------------------------------------
% knitr look-a-like and environment
\usepackage[dvipsnames]{xcolor}
\usepackage{framed}
\usepackage{alltt}

\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%

\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX


%----------------------------------------------------------------------------
% math packages
\usepackage{amsmath}
\usepackage{xfrac}


%----------------------------------------------------------------------------
% thesis style
\usepackage[%
    beramono,
    eulermath,
    pdfspacing,
    eulerchapternumbers,
    dottedtoc,
    floatperchapter,
    parts,
    tabheaders,    % custom header
    %linedheaders, %  changes  the  look  of  the  chapter  headings  a  bit by adding a horizontal line above the chapter title. 
]{classicthesis}



%----------------------------------------------------------------------------
% % define page size and margins for the final print
% space between text and footer
\setlength{\footskip}{10mm}

% b5 pdf
\usepackage[twoside]{geometry}
\geometry{
  includehead,
  includefoot,
  right=20mm,
  left=20mm,
  bottom=10mm, % space from bottomn to footer (space from text to bottom = footskip + bottom)
  top=10mm,    % space from top to text
  }
\geometry{
  paper=b5paper
}



% % % b5 on a4 page with crop marks
% \usepackage[twoside,a4paper,layout=b5paper]{geometry}
% \geometry{
%   includehead,
%   includefoot,
%   right=20mm,
%   left=20mm,
%   bottom=10mm,
%   top=10mm,
%   }
%  % fix twoside, to match in center.
%  % see http://tex.stackexchange.com/questions/45283/how-can-i-use-the-layout-and-twoside-options-of-the-geometry-package
% \makeatletter
% \newlength\hcorr
% \setlength\hcorr{\paperwidth}
% \addtolength\hcorr{-\Gm@layoutwidth}
% \makeatother
% \geometry{
%   layouthoffset=.5\hcorr,  
%   bindingoffset=5mm,
%   showcrop,
%   % showframe,
% }


%----------------------------------------------------------------------------
% %% increase line-spacing
\usepackage{setspace}
\setstretch{1.1}


%----------------------------------------------------------------------------
\usepackage{float}


%----------------------------------------------------------------------------
% tables
\usepackage{tabularx}
\usepackage{longtable}
% define a new column type (I call it P) which invokes \raggedright and other stuff necessary to handle all columns.
% this fixes underfull hboxes in longtable
\usepackage{array}
\newcolumntype{P}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}
\usepackage{enumerate}


%----------------------------------------------------------------------------
% fixes for marginpar and latex
\usepackage{mparhack}
% \usepackage{fixltx2e} 
\usepackage{scrhack}


%----------------------------------------------------------------------------
% smaller cpations
\usepackage[font={small}]{caption}


%----------------------------------------------------------------------------
% % indexing
% \usepackage{makeidx}
% \makeindex


%----------------------------------------------------------------------------
% graphics, figures, captions
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{external}
\usetikzlibrary{shapes, arrows, positioning, calc}
\tikzexternalize[optimize=false]
\tikzsetexternalprefix{tikz/}


%----------------------------------------------------------------------------
% insert pdfs
\usepackage{pdfpages}

% floats 
\usepackage{placeins}
% It gives you a \FloatBarrier command that you can use to prevent floats to appear beyond some point in your document. Use it as
% \FloatBarrier
% \section{My new section} % will not include floats from previous sections


%----------------------------------------------------------------------------
% bibliography
\usepackage{csquotes}
\usepackage[%
    backend=biber, 
    refsection=chapter,   % references per chapter
    natbib=true,          % natbib style (citep & citet)
    style=authoryear,     %,
    dashed=false,         % option for author yea
    doi=false,            %  no doi
    isbn=false,           % no isbn
    url=true,             % include url
    hyperref=auto,        %
    maxbibnames=99,       % all names in biobilography
    maxcitenames=2,       % max 2 name in citation
    giveninits=true,      % render all first and middle names as initials.  
    uniquename=init,
    uniquelist=false,     %
    sorting=nyt,          % year, name title (for text citations), changed to
                          % sorting=nyt within each chapter for bibliography.
    sortcites             % 
]{biblatex}

%% Customizatiomns
% Bibliography
% increase space between entries in bibliography
\setlength{\bibitemsep}{1em} 
% Change Bibliograpgy to "References"
\DefineBibliographyStrings{english}{%
  bibliography = {References},
}
%% Citation Styles
% remove language entry and urldate from every item
\AtEveryBibitem{%
  \clearlist{language}%
}
\AtEveryBibitem{%
  \clearfield{urlyear}
}
\AtEveryBibitem{%
  \clearfield{type}
}

%% remove 'In:' before journal names
% source: http://tex.stackexchange.com/questions/10682/suppress-in-biblatex
\renewbibmacro{in:}{%
  \ifentrytype{article}{}{\printtext{\bibstring{in}\intitlepunct}}}

%% remove pp. before pages
\DeclareFieldFormat{pages}{#1}

%% format volume and number as Volume(Number)
% source http://tex.stackexchange.com/questions/81569/biblatex-parentheses-around-the-volume-number-of-an-article#81573
\renewbibmacro*{volume+number+eid}{%
  \printfield{volume}%
%  \setunit*{\adddot}% DELETED
  \setunit*{\addnbthinspace}% NEW (optional); there's also \addnbspace
  \printfield{number}%
  \setunit{\addcomma\space}%
  \printfield{eid}}
\DeclareFieldFormat[article]{number}{\mkbibparens{#1}}

%% force fullcite to use maxnames (used in publications.tex)
\preto\fullcite{\AtNextCite{\defcounter{maxnames}{99}}}

%% add bib files
\addbibresource[label=publications]{frontbackmatter/publications.bib}
\addbibresource[label=introduction]{chapters/introduction/Introduction.bib}
\addbibresource[label=usetheglm]{chapters/usetheglm/refs_usetheglm.bib}
% \addbibresource[label=smallstreams]{chapters/smallstreams/references.bib}
\addbibresource[label=taxize]{chapters/taxize/refs_taxize.bib}
\addbibresource[label=webchem]{chapters/webchem/references.bib}
% \addbibresource[label=discussion]{chapters/discussion/references.bib}

% dummy counter for correct TOC etc
\newcounter{dummy}


%----------------------------------------------------------------------------
% signature function
\newcommand{\signature}[1]{%
  \vspace{4em}
  \parbox{0.9\textwidth}{
    Neustadt a.d. Weinstraße, \\
    \myTime 

    \hfill 
    \parbox{4cm}{
      \centering
      \rule{4cm}{1pt}\\
       #1 
    }
  }
}


%----------------------------------------------------------------------------
% hyperref
\usepackage{hyperref}
\hypersetup{%
    draft=false, % = no hyperlinking at all (useful in b/w printouts)
    colorlinks=true, 
    linktocpage=true, 
    pdfstartpage=1, 
    pdfstartview=FitV,%
    % uncomment the following line if you want to have black links (e.g., for printing)
    %colorlinks=false, linktocpage=false, pdfborder={0 0 0}, pdfstartpage=1, pdfstartview=FitV,% 
    breaklinks=true, 
    pdfpagemode=UseNone, 
    pageanchor=true, 
    pdfpagemode=UseOutlines,%
    plainpages=false, 
    % bookmarks=true,
    bookmarksnumbered, 
    bookmarksopen=true, 
    bookmarksopenlevel=1,%
    hypertexnames=true, 
    pdfhighlight=/O,
    urlcolor=webbrown, 
    linkcolor=RoyalBlue, 
    citecolor=webgreen, 
    % uncomment the following line if you want to have black
    %pagecolor=RoyalBlue,%
    %urlcolor=Black, linkcolor=Black, citecolor=Black, %pagecolor=Black,%
    pdftitle={\myTitle},%
    pdfauthor={\myName, \myUni},%
    pdfsubject={},%
    pdfkeywords={},%
}   
\usepackage{bookmark}

\renewcommand{\subsectionautorefname}{Subsection}
\renewcommand{\sectionautorefname}{Section}
\renewcommand{\chapterautorefname}{Chapter}

